import{c as B,r as t,j as e,m as G,f as H,a as f,y as g}from"./index-BFIRCOFm.js";import{f as u}from"./dateUtils-CoizxC4S.js";import{B as j}from"./button-C7fbYyUg.js";import{T as O,a as z,b,c as n,d as M,e as a}from"./table-Cr_GSO-f.js";import{D as R,a as _,b as $,c as J,d as W}from"./dialog-ngHf6tSK.js";import{B as q}from"./book-BGuU8E9L.js";import{U as K}from"./user-gTeU-oJe.js";import{C as Q}from"./calendar-CFygCBbd.js";import{L as N}from"./link-CZYwcepb.js";import"./Combination-Cr6E-lIU.js";import"./tslib.es6-BUas5LQb.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V=B("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]),U=t.forwardRef(({className:d,type:i,...l},r)=>e.jsx("input",{type:i,className:G("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",d),ref:r,...l}));U.displayName="Input";const oe=()=>{var C;const[d]=H(),i=d.get("id"),l=d.get("courseId"),[r,A]=t.useState(null),[h,k]=t.useState([]),[T,y]=t.useState(!1),[v,w]=t.useState(null),[P,m]=t.useState(!1),[o,I]=t.useState(null),[p,S]=t.useState(""),[L,D]=t.useState(!1);t.useEffect(()=>{!i||!l||(y(!0),w(null),Promise.all([fetch(f+`GroupLesson/Student/${i}`,{credentials:"include"}),fetch(f+`Courses/${l}`,{credentials:"include"})]).then(async([s,x])=>{if(!s.ok)throw new Error("Failed to fetch sessions");if(!x.ok)throw new Error("Failed to fetch course");const c=await s.json();k(c.data||[]);const F=await x.json();A(F.data||null)}).catch(s=>w(s.message||"Unknown error")).finally(()=>y(!1)))},[i,l]);const E=async()=>{if(!o||!p){g.error("Please provide a valid assignment link.");return}D(!0);try{const s=await fetch(`${f}GroupAssignments/sessions/${o.id}/submissions`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({submissionLink:p})}),x=await s.json();if(!s.ok)throw new Error(x.message||"Failed to upload assignment");k(h.map(c=>c.id===o.id?{...c,assignmentSubmitted:!0}:c)),m(!1),S(""),g.success("Assignment uploaded successfully.")}catch(s){g.error(s.message||"Failed to upload assignment.")}finally{D(!1)}};return i?T?e.jsx("div",{className:"p-8 text-center",children:"Loading..."}):v?e.jsx("div",{className:"p-8 text-center text-red-500",children:v}):r?e.jsxs("div",{className:"space-y-6 p-4",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("h1",{className:"text-3xl font-bold",children:r.name}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"flex items-center space-x-4 p-4 rounded-lg border",children:[e.jsx(q,{size:24,className:"text-primary"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Course"}),e.jsx("p",{className:"font-medium",children:r.name})]})]}),e.jsxs("div",{className:"flex items-center space-x-4 p-4 rounded-lg border",children:[e.jsx(K,{size:24,className:"text-primary"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Instructor"}),e.jsx("p",{className:"font-medium",children:(C=r.instructor)==null?void 0:C.name})]})]}),e.jsxs("div",{className:"flex items-center space-x-4 p-4 rounded-lg border",children:[e.jsx(Q,{size:24,className:"text-primary"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Start Date"}),e.jsx("p",{className:"font-medium",children:u(r.scheduleStart)})]})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h2",{className:"text-xl font-semibold",children:"Sessions"}),e.jsx("div",{className:"border rounded-md overflow-x-auto",children:e.jsxs(O,{className:"min-w-full",children:[e.jsx(z,{children:e.jsxs(b,{children:[e.jsx(n,{className:"whitespace-nowrap",children:"Order"}),e.jsx(n,{className:"whitespace-nowrap",children:"Date"}),e.jsx(n,{className:"text-center",children:"Session"}),e.jsx(n,{className:"text-center",children:"Recording"}),e.jsx(n,{className:"text-center",children:"Assignment"}),e.jsx(n,{className:"whitespace-nowrap",children:"Deadline"}),e.jsx(n,{className:"text-center",children:"Upload"})]})}),e.jsx(M,{children:h.length>0?h.map(s=>e.jsxs(b,{children:[e.jsx(a,{className:"whitespace-nowrap",children:s.order}),e.jsx(a,{className:"whitespace-nowrap",children:u(s.sessionDate)}),e.jsx(a,{className:"text-center",children:s.videoLink&&e.jsx("a",{href:s.videoLink,target:"_blank",rel:"noopener noreferrer",className:"inline-block text-primary hover:text-primary/80",title:"Session Link",children:e.jsx(N,{className:"h-5 w-5"})})}),e.jsx(a,{className:"text-center",children:s.sessionLink&&e.jsx("a",{href:s.sessionLink,target:"_blank",rel:"noopener noreferrer",className:"inline-block text-primary hover:text-primary/80",title:"Recording Link",children:e.jsx(N,{className:"h-5 w-5"})})}),e.jsx(a,{className:"text-center",children:s.assignmentLink&&e.jsx("a",{href:s.assignmentLink,target:"_blank",rel:"noopener noreferrer",className:"inline-block text-primary hover:text-primary/80",title:"Assignment Link",children:e.jsx(N,{className:"h-5 w-5"})})}),e.jsx(a,{className:"whitespace-nowrap",children:u(s.assignmentDeadline)}),e.jsx(a,{className:"text-center",children:e.jsx(j,{variant:s.assignmentSubmitted?"secondary":"outline",size:"icon",className:"h-8 w-8 mx-auto",onClick:()=>{I(s),m(!0)},title:"Upload Assignment",children:e.jsx(V,{className:"h-4 w-4"})})})]},s.id)):e.jsx(b,{children:e.jsx(a,{colSpan:6,className:"text-center py-4",children:"No sessions available for this lesson."})})})]})})]}),e.jsx(R,{open:P,onOpenChange:m,children:e.jsxs(_,{className:"sm:max-w-md",children:[e.jsx($,{children:e.jsx(J,{children:"Upload Assignment"})}),e.jsx("div",{className:"grid gap-4 py-4",children:e.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{htmlFor:"link-type",className:"block text-sm font-medium",children:"Select Platform"}),e.jsxs("select",{id:"link-type",className:"block w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",children:[e.jsx("option",{value:"drive",children:"Google Drive"}),e.jsx("option",{value:"github",children:"GitHub"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{htmlFor:"assignment-link",className:"block text-sm font-medium",children:"Assignment Link"}),e.jsx(U,{id:"assignment-link",type:"url",placeholder:"Paste your Google Drive or GitHub link here",value:p,onChange:s=>S(s.target.value)}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Make sure the link is accessible to the instructor"})]}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Upload your assignment for the session dated ",o&&u(o.sessionDate)]})]})}),e.jsxs(W,{children:[e.jsx(j,{type:"button",variant:"secondary",onClick:()=>m(!1),children:"Cancel"}),e.jsx(j,{type:"button",onClick:E,disabled:L,children:L?"Submitting...":"Submit Link"})]})]})})]}):null:e.jsx("div",{className:"flex flex-col items-center justify-center min-h-[40vh]",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-md px-8 py-10 flex flex-col items-center border border-gray-200",children:[e.jsx("svg",{width:"48",height:"48",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",className:"text-gray-400 mb-4",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12c0 4.97-4.03 9-9 9s-9-4.03-9-9 4.03-9 9-9 9 4.03 9 9z"})}),e.jsx("div",{className:"text-lg font-semibold text-gray-700 mb-2",children:"No available session"}),e.jsx("div",{className:"text-gray-500 text-sm",children:"Please check back later or contact support if you think this is a mistake."})]})})};export{oe as default};
