import{r as t,b as l,a as c,y as u,j as s}from"./index-C_fr4Erx.js";import{B as S}from"./button-BPxerCch.js";import{C as U,a as _,c as V,b as Y}from"./card-DGBTJEaR.js";import{T as q,a as J,b as p,c as o,d as K,e as i}from"./table-Ch59DlqH.js";import{C as O}from"./ConfirmationDialog-ooO5-hCw.js";const oe=()=>{const[b,g]=t.useState([]),[w,v]=t.useState([]),[y,C]=t.useState([]),[I,a]=t.useState(!1),[x,m]=t.useState(""),[r,N]=t.useState(""),[d,f]=t.useState(""),[Q,k]=t.useState(!1),[E,h]=t.useState(!1),[F,G]=t.useState(null),[W,L]=t.useState(!1),[X,P]=t.useState(null),[D,T]=t.useState([]),[Z,$]=t.useState({submissionLink:"",wasPresent:!1,evaluationScore:0,bonusPoints:0,submissionDate:"",comments:"",sessionId:"",studentId:""});t.useEffect(()=>{A(),H()},[]),t.useEffect(()=>{r&&B(r)},[r]),t.useEffect(()=>{d&&j(d)},[d]);const A=async()=>{a(!0);try{const e=await l.get(`${c}Group`);g(e.data.data||[])}catch{m("Failed to load groups"),u.error("Failed to load groups")}a(!1)},B=async e=>{a(!0);try{const n=await l.get(`${c}GroupLesson/${e}/sessions`);v(n.data.data||[])}catch{m("Failed to load sessions"),u.error("Failed to load sessions")}a(!1)},j=async e=>{a(!0);try{const n=await l.get(`${c}GroupAssignments/sessions/${e}/submissions`);C(n.data.data||[])}catch{m("Failed to load submissions"),u.error("Failed to load submissions")}a(!1)},H=async()=>{try{const e=await l.get(`${c}User/students`);T(e.data.data||[])}catch{}},R=async e=>{a(!0);try{await l.delete(`${c}GroupAssignments/submissions/${e}`),u.success("Submission deleted successfully!"),j(d),h(!1)}catch{m("Failed to delete submission"),u.error("Failed to delete submission")}a(!1)},z=e=>{$({submissionLink:e.submissionLink,wasPresent:e.wasPresent,evaluationScore:e.evaluationScore,bonusPoints:e.bonusPoints,submissionDate:e.submissionDate,comments:e.comments,sessionId:e.sessionId,studentId:e.studentId}),L(!0),P(e.id),k(!0)};return s.jsxs("div",{className:"space-y-6",children:[I&&s.jsx("div",{className:"text-blue-600",children:"Loading..."}),x&&s.jsx("div",{className:"text-red-500",children:x}),E&&s.jsx(O,{message:"Are you sure you want to delete this submission?",onConfirm:()=>R(F),onCancel:()=>h(!1)}),s.jsxs(U,{children:[s.jsxs(_,{className:"border-b flex flex-col md:flex-row md:justify-between md:items-center gap-2",children:[s.jsx(V,{className:"text-xl font-semibold",children:"Group Assignment Submissions"}),s.jsxs("div",{className:"flex gap-2 flex-wrap",children:[s.jsxs("select",{className:"border rounded px-2 py-1",value:r,onChange:e=>{N(e.target.value),f("")},children:[s.jsx("option",{value:"",children:"Select Group"}),b.map(e=>s.jsx("option",{value:e.id,children:e.name},e.id))]}),s.jsxs("select",{className:"border rounded px-2 py-1",value:d,onChange:e=>f(e.target.value),disabled:!r,children:[s.jsx("option",{value:"",children:"Select Session"}),w.map(e=>s.jsx("option",{value:e.id,children:e.title},e.id))]})]})]}),s.jsx(Y,{className:"p-0",children:s.jsxs(q,{children:[s.jsx(J,{children:s.jsxs(p,{children:[s.jsx(o,{children:"Student"}),s.jsx(o,{children:"Submission Link"}),s.jsx(o,{children:"Present"}),s.jsx(o,{children:"Score"}),s.jsx(o,{children:"Bonus"}),s.jsx(o,{children:"Date"}),s.jsx(o,{children:"Comments"}),s.jsx(o,{children:"Actions"})]})}),s.jsx(K,{children:y.map(e=>{var n;return s.jsxs(p,{children:[s.jsx(i,{children:((n=D.find(M=>M.id===e.studentId))==null?void 0:n.fullName)||e.studentId}),s.jsx(i,{children:e.submissionLink?s.jsx("a",{href:e.submissionLink,target:"_blank",rel:"noopener noreferrer",children:"View"}):"-"}),s.jsx(i,{children:e.wasPresent?"Yes":"No"}),s.jsx(i,{children:e.evaluationScore}),s.jsx(i,{children:e.bonusPoints}),s.jsx(i,{children:e.submissionDate}),s.jsx(i,{children:e.comments}),s.jsx(i,{children:s.jsxs("div",{className:"flex gap-2",children:[s.jsx(S,{variant:"outline",size:"sm",onClick:()=>z(e),children:"Edit"}),s.jsx(S,{variant:"destructive",size:"sm",onClick:()=>{h(!0),G(e.id)},children:"Delete"})]})})]},e.id)})})]})})]})]})};export{oe as default};
