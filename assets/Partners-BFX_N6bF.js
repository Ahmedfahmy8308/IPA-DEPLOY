import{r,a as f,j as e,A as k,y as c}from"./index-DPuvoll-.js";import{B as d}from"./button-CYdQFzX_.js";import{I as N}from"./input-ob3Opmf_.js";import{C as J,a as K,c as Q,b as $,d as V}from"./card-CYNz0zcd.js";import{T as X,a as Y,b as I,c as m,d as Z,e as u}from"./table-C7SWgxsZ.js";import ee from"./DashboardLayout-DUU7Lqwx.js";import{C as L}from"./ConfirmationDialog-BtPhdutN.js";import{P as se}from"./plus-CAHAXaj3.js";import{I as te}from"./image-KAyWfBk0.js";import{P as ae}from"./pencil-XaAp15ZU.js";import{T as re}from"./trash-2-DU9wkDME.js";import"./avatar-BwAIo9yI.js";import"./chevron-down-BShv5FgQ.js";import"./menu-DDNcVij5.js";import"./house-CU8__SLY.js";import"./settings-C6a9jyWU.js";import"./user-gaA5Cs8y.js";import"./proxy-Fs6e6fcF.js";import"./index-Co9Zm7B-.js";const Pe=()=>{const[v,y]=r.useState([]),[D,l]=r.useState(!1),[P,o]=r.useState(""),[U,j]=r.useState(!1),[a,i]=r.useState({name:"",image:null,website:"",contact:""}),[x,p]=r.useState(""),[h,C]=r.useState(!1),[R,E]=r.useState(null),[z,g]=r.useState(null),[S,T]=r.useState(null),[F,b]=r.useState(null);r.useEffect(()=>{A()},[]);const A=async()=>{l(!0),o("");try{const s=await fetch(`${f}Partners`,{credentials:"include"});if(!s.ok)throw new Error(`Error ${s.status}: ${s.statusText}`);const n=(await s.json()).data;y(n||[])}catch{o("Failed to load partners")}l(!1)},B=s=>{const t=s.target.files[0];if(!t)return;i(G=>({...G,image:t}));const n=new FileReader;n.onloadend=()=>{p(typeof n.result=="string"?n.result:"")},n.readAsDataURL(t)},_=async()=>{if(l(!0),o(""),!h&&!a.image){o("Logo is required."),l(!1),c.error("Logo is required.");return}try{const s=new FormData;if(s.append("Name",a.name),s.append("Contact",a.contact),s.append("Website",a.website),a.image&&typeof a.image!="string"&&s.append("Image",a.image),h){s.append("Id",String(R));const t=await fetch(`${f}Partners`,{method:"PUT",body:s,credentials:"include"});if(!t.ok)throw new Error(`Error ${t.status}: ${t.statusText}`);const n=await t.json();c.success("Partner updated successfully!")}else{const t=await fetch(`${f}Partners`,{method:"POST",body:s,credentials:"include"});if(!t.ok)throw new Error(`Error ${t.status}: ${t.statusText}`);const n=await t.json();c.success("Partner added successfully!")}await A(),w()}catch{o("Failed to save partner"),c.error("Failed to save partner")}l(!1)},H=s=>{C(!0),E(s.id),i({name:s.name,image:null,website:s.website||"",contact:s.contact||""}),p(s.logoUrl?k+s.logoUrl:""),j(!0)},M=s=>{T(s),g("delete")},W=async()=>{l(!0),o("");try{const s=await fetch(`${f}Partners/${S}`,{method:"DELETE",credentials:"include"});if(!s.ok)throw new Error(`Error ${s.status}: ${s.statusText}`);const t=await s.json();y(v.filter(n=>n.id!==S)),T(null),g(null),c.success("Partner deleted successfully!")}catch{o("Failed to delete partner"),c.error("Failed to delete partner")}l(!1)},q=()=>{b(h?"edit":"add")},O=async()=>{b(null),await _()},w=()=>{i({name:"",image:null,website:"",contact:""}),p(""),C(!1),E(null),j(!1)};return e.jsx(ee,{children:e.jsxs("div",{className:"space-y-6",children:[D&&e.jsx("div",{className:"text-blue-600",children:"Loading..."}),P&&e.jsx("div",{className:"text-red-500",children:P}),z==="delete"&&e.jsx(L,{message:"Are you sure you want to delete this partner?",onConfirm:W,onCancel:()=>g(null)}),F&&e.jsx(L,{message:F==="add"?"Are you sure you want to add this partner?":"Are you sure you want to update this partner?",onConfirm:O,onCancel:()=>b(null)}),e.jsxs(J,{children:[e.jsx(K,{className:"border-b",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx(Q,{className:"text-xl font-semibold",children:"Partners Management"}),e.jsxs(d,{onClick:()=>{w(),j(!0)},className:"gap-2",children:[e.jsx(se,{size:16}),"Add Partner"]})]})}),U&&e.jsxs($,{className:"pt-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Partner Name"}),e.jsx(N,{placeholder:"Enter partner name",value:a.name,onChange:s=>i({...a,name:s.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Website URL"}),e.jsx(N,{placeholder:"https://example.com",value:a.website,onChange:s=>i({...a,website:s.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Contact Email"}),e.jsx(N,{placeholder:"contact@partner.com",value:a.contact,onChange:s=>i({...a,contact:s.target.value})})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Partner Logo"}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"border rounded-md p-2 w-full",children:e.jsx("input",{type:"file",onChange:B,className:"w-full text-sm",accept:"image/*"})}),x&&e.jsx("img",{src:x,alt:"Preview",className:"w-16 h-16 rounded-md object-cover border"})]})]}),x&&e.jsx("div",{className:"flex justify-center",children:e.jsx("img",{src:x,alt:"Partner Logo Preview",className:"max-w-full h-32 object-contain border rounded"})})]})]}),e.jsxs(V,{className:"flex justify-end gap-2 pt-6 border-t",children:[e.jsx(d,{variant:"outline",onClick:w,children:"Cancel"}),e.jsx(d,{onClick:q,className:"bg-blue-600 hover:bg-blue-700",children:h?"Update Partner":"Add Partner"})]})]}),e.jsx($,{className:"p-0",children:e.jsxs(X,{children:[e.jsx(Y,{children:e.jsxs(I,{children:[e.jsx(m,{className:"w-[100px]",children:"Logo"}),e.jsx(m,{children:"Partner"}),e.jsx(m,{children:"Contact"}),e.jsx(m,{children:"Website"}),e.jsx(m,{className:"text-right",children:"Actions"})]})}),e.jsx(Z,{children:v.map(s=>e.jsxs(I,{children:[e.jsx(u,{children:s.logoUrl?e.jsx("img",{src:k+s.logoUrl,className:"w-12 h-12 rounded object-cover border",alt:s.name}):e.jsx("div",{className:"w-12 h-12 rounded border flex items-center justify-center bg-gray-50",children:e.jsx(te,{className:"w-5 h-5 text-gray-400"})})}),e.jsx(u,{className:"font-medium",children:s.name}),e.jsx(u,{children:s.contact?e.jsx("a",{href:`mailto:${s.contact}`,className:"text-blue-600 hover:underline text-sm",children:s.contact}):e.jsx("span",{className:"text-gray-400 text-sm",children:"Not provided"})}),e.jsx(u,{children:s.website?e.jsx("a",{href:s.website,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline text-sm",children:s.website.replace(/^https?:\/\//,"")}):e.jsx("span",{className:"text-gray-400 text-sm",children:"Not provided"})}),e.jsx(u,{className:"text-right",children:e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsxs(d,{variant:"outline",size:"sm",onClick:()=>H(s),children:[e.jsx(ae,{size:14,className:"mr-1"}),"Edit"]}),e.jsxs(d,{variant:"destructive",size:"sm",onClick:()=>M(s.id),children:[e.jsx(re,{size:14,className:"mr-1"}),"Delete"]})]})})]},s.id))})]})})]})]})})};export{Pe as default};
