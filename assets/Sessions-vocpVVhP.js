import{r as i,b as u,a as x,y as l,j as e}from"./index-DPuvoll-.js";import{B as o}from"./button-CYdQFzX_.js";import{I as d}from"./input-ob3Opmf_.js";import{C as H,a as M,c as O,b as N}from"./card-CYNz0zcd.js";import{T as _,a as q,b as C,c,d as P,e as m}from"./table-C7SWgxsZ.js";import{C as J}from"./ConfirmationDialog-BtPhdutN.js";const ee=()=>{const[G,I]=i.useState([]),[f,y]=i.useState([]),[A,r]=i.useState(!1),[w,p]=i.useState(""),[t,F]=i.useState(""),[T,b]=i.useState(!1),[E,$]=i.useState(null),[k,S]=i.useState(!1),[R,D]=i.useState(null),[L,g]=i.useState(!1),[a,n]=i.useState({title:"",description:"",videoLink:"",assignmentLink:"",sessionDate:"",assignmentDeadline:"",order:1,courseGroupId:""}),h=()=>{n({title:"",description:"",videoLink:"",assignmentLink:"",sessionDate:"",assignmentDeadline:"",order:1,courseGroupId:t}),S(!1),D(null),g(!1)};i.useEffect(()=>{U()},[]),i.useEffect(()=>{t?(j(t),h()):(y([]),h())},[t]);const U=async()=>{r(!0);try{const s=await u.get(`${x}Group`);I(s.data.data||[])}catch{p("Failed to load groups"),l.error("Failed to load groups")}r(!1)},j=async s=>{r(!0);try{const v=await u.get(`${x}GroupLesson/${s}/sessions`);y(v.data.data||[])}catch{p("Failed to load sessions"),l.error("Failed to load sessions")}r(!1)},V=async()=>{if(!a.title||!a.sessionDate||!t){l.error("Title, date, and group are required");return}r(!0);try{if(k){const s={title:a.title,description:a.description,videoLink:a.videoLink,assignmentLink:a.assignmentLink,sessionDate:a.sessionDate,assignmentDeadline:a.assignmentDeadline,order:a.order};await u.put(`${x}GroupLesson/sessions/${R}`,s),l.success("Session updated successfully!")}else{const s={title:a.title,description:a.description,videoLink:a.videoLink,assignmentLink:a.assignmentLink,sessionDate:a.sessionDate,assignmentDeadline:a.assignmentDeadline,order:a.order,courseGroupId:Number(t)};await u.post(`${x}GroupLesson/${t}/sessions`,s),l.success("Session added successfully!")}j(t),h()}catch{p("Failed to save session"),l.error("Failed to save session")}r(!1)},z=async s=>{r(!0);try{await u.delete(`${x}GroupLesson/sessions/${s}`),l.success("Session deleted successfully!"),j(t),b(!1)}catch{p("Failed to delete session"),l.error("Failed to delete session")}r(!1)},B=s=>{n({title:s.title,description:s.description,videoLink:s.videoLink,assignmentLink:s.assignmentLink,sessionDate:s.sessionDate?s.sessionDate.substring(0,10):"",assignmentDeadline:s.assignmentDeadline?s.assignmentDeadline.substring(0,10):"",order:s.order,courseGroupId:s.courseGroupId}),S(!0),D(s.id),g(!0)};return e.jsxs("div",{className:"container mx-auto px-4 py-8",children:[A&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsx("div",{className:"bg-white p-6 rounded-lg shadow-lg",children:e.jsx("p",{className:"text-blue-600 font-medium",children:"Loading..."})})}),w&&e.jsx("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-4",children:w}),T&&e.jsx(J,{message:"Are you sure you want to delete this session?",onConfirm:()=>z(E),onCancel:()=>b(!1)}),e.jsxs(H,{className:"shadow-lg",children:[e.jsx(M,{className:"bg-[#121b2e] text-white rounded-t-lg",children:e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[e.jsx(O,{className:"text-2xl font-bold",children:"Group Sessions Management"}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 w-full md:w-auto",children:[e.jsxs("select",{className:"bg-white text-gray-800 rounded-md px-4 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",value:t,onChange:s=>F(s.target.value),children:[e.jsx("option",{value:"",children:"Select a group..."}),G.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))]}),t&&e.jsx(o,{className:"bg-[#fff] text-black hover:bg-green-400",onClick:()=>g(!0),children:"+ Add New Session"})]})]})}),t&&L&&e.jsxs(N,{className:"border-b p-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 font-medium mb-2",children:"Session Title"}),e.jsx(d,{value:a.title,onChange:s=>n({...a,title:s.target.value}),placeholder:"Session title",className:"w-full"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 font-medium mb-2",children:"Description"}),e.jsx(d,{value:a.description,onChange:s=>n({...a,description:s.target.value}),placeholder:"Session description",className:"w-full"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 font-medium mb-2",children:"Video Link"}),e.jsx(d,{value:a.videoLink,onChange:s=>n({...a,videoLink:s.target.value}),placeholder:"Video URL",className:"w-full"})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 font-medium mb-2",children:"Assignment Link"}),e.jsx(d,{value:a.assignmentLink,onChange:s=>n({...a,assignmentLink:s.target.value}),placeholder:"Assignment URL",className:"w-full"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 font-medium mb-2",children:"Session Date"}),e.jsx(d,{type:"date",value:a.sessionDate,onChange:s=>n({...a,sessionDate:s.target.value}),className:"w-full"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 font-medium mb-2",children:"Assignment Deadline"}),e.jsx(d,{type:"date",value:a.assignmentDeadline,onChange:s=>n({...a,assignmentDeadline:s.target.value}),className:"w-full"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 font-medium mb-2",children:"Order"}),e.jsx(d,{type:"number",value:a.order,onChange:s=>n({...a,order:Number(s.target.value)}),className:"w-full"})]})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[e.jsx(o,{variant:"outline",onClick:h,className:"border-gray-300 hover:bg-gray-100",children:"Cancel"}),e.jsx(o,{onClick:V,className:"bg-blue-600 hover:bg-blue-700",children:k?"Update Session":"Save Session"})]})]}),t&&f.length>0&&e.jsx(N,{className:"p-0",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(_,{className:"min-w-full",children:[e.jsx(q,{className:"bg-gray-50",children:e.jsxs(C,{children:[e.jsx(c,{className:"px-6 py-3 text-left font-medium text-gray-500 uppercase tracking-wider",children:"Title"}),e.jsx(c,{className:"px-6 py-3 text-left font-medium text-gray-500 uppercase tracking-wider",children:"Date"}),e.jsx(c,{className:"px-6 py-3 text-left font-medium text-gray-500 uppercase tracking-wider",children:"Order"}),e.jsx(c,{className:"px-6 py-3 text-left font-medium text-gray-500 uppercase tracking-wider",children:"Video"}),e.jsx(c,{className:"px-6 py-3 text-left font-medium text-gray-500 uppercase tracking-wider",children:"Assignment"}),e.jsx(c,{className:"px-6 py-3 text-left font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsx(P,{className:"bg-white divide-y divide-gray-200",children:f.map(s=>e.jsxs(C,{className:"hover:bg-gray-50",children:[e.jsxs(m,{className:"px-6 py-4 whitespace-nowrap",children:[e.jsx("div",{className:"font-medium text-gray-900",children:s.title}),s.description&&e.jsx("div",{className:"text-sm text-gray-500 truncate max-w-xs",children:s.description})]}),e.jsx(m,{className:"px-6 py-4 whitespace-nowrap",children:s.sessionDate?s.sessionDate.substring(0,10):""}),e.jsx(m,{className:"px-6 py-4 whitespace-nowrap",children:s.order}),e.jsx(m,{className:"px-6 py-4 whitespace-nowrap",children:s.videoLink?e.jsx("a",{href:s.videoLink,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-800 hover:underline",children:"View"}):"-"}),e.jsx(m,{className:"px-6 py-4 whitespace-nowrap",children:s.assignmentLink?e.jsx("a",{href:s.assignmentLink,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-800 hover:underline",children:"Assignment"}):"-"}),e.jsx(m,{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx(o,{variant:"outline",size:"sm",onClick:()=>B(s),className:"text-blue-600 border-blue-600 hover:bg-blue-50",children:"Edit"}),e.jsx(o,{variant:"destructive",size:"sm",onClick:()=>{b(!0),$(s.id)},children:"Delete"})]})})]},s.id))})]})})}),t&&f.length===0&&!L&&e.jsxs(N,{className:"p-8 text-center",children:[e.jsx("div",{className:"text-gray-500",children:"No sessions found for this group. Start by adding a new session."}),e.jsx(o,{className:"mt-4 bg-blue-600 hover:bg-blue-700",onClick:()=>g(!0),children:"+ Add New Session"})]})]})]})};export{ee as default};
