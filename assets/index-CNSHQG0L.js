import{P as H,r as s,aa as V,j as d,Q as D,T as p,K as z,M as Q,Y as q}from"./index-MCFfI99p.js";import{u as J}from"./Combination-iBoQczz2.js";import{u as W}from"./index-CJxNwZRv.js";var A="rovingFocusGroup.onEntryFocus",X={bubbles:!1,cancelable:!0},I="RovingFocusGroup",[_,G,Z]=V(I),[$,fe]=H(I,[Z]),[ee,te]=$(I),N=s.forwardRef((e,r)=>d.jsx(_.Provider,{scope:e.__scopeRovingFocusGroup,children:d.jsx(_.Slot,{scope:e.__scopeRovingFocusGroup,children:d.jsx(oe,{...e,ref:r})})}));N.displayName=I;var oe=s.forwardRef((e,r)=>{const{__scopeRovingFocusGroup:c,orientation:t,loop:E=!1,dir:w,currentTabStopId:v,defaultCurrentTabStopId:C,onCurrentTabStopIdChange:T,onEntryFocus:m,preventScrollOnEntryFocus:a=!1,...b}=e,F=s.useRef(null),g=z(r,F),R=W(w),[o,l]=Q({prop:v,defaultProp:C??null,onChange:T,caller:I}),[S,u]=s.useState(!1),i=q(m),j=G(c),x=s.useRef(!1),[k,y]=s.useState(0);return s.useEffect(()=>{const n=F.current;if(n)return n.addEventListener(A,i),()=>n.removeEventListener(A,i)},[i]),d.jsx(ee,{scope:c,orientation:t,dir:R,loop:E,currentTabStopId:o,onItemFocus:s.useCallback(n=>l(n),[l]),onItemShiftTab:s.useCallback(()=>u(!0),[]),onFocusableItemAdd:s.useCallback(()=>y(n=>n+1),[]),onFocusableItemRemove:s.useCallback(()=>y(n=>n-1),[]),children:d.jsx(D.div,{tabIndex:S||k===0?-1:0,"data-orientation":t,...b,ref:g,style:{outline:"none",...e.style},onMouseDown:p(e.onMouseDown,()=>{x.current=!0}),onFocus:p(e.onFocus,n=>{const L=!x.current;if(n.target===n.currentTarget&&L&&!S){const P=new CustomEvent(A,X);if(n.currentTarget.dispatchEvent(P),!P.defaultPrevented){const h=j().filter(f=>f.focusable),U=h.find(f=>f.active),B=h.find(f=>f.id===o),Y=[U,B,...h].filter(Boolean).map(f=>f.ref.current);M(Y,a)}}x.current=!1}),onBlur:p(e.onBlur,()=>u(!1))})})}),O="RovingFocusGroupItem",K=s.forwardRef((e,r)=>{const{__scopeRovingFocusGroup:c,focusable:t=!0,active:E=!1,tabStopId:w,children:v,...C}=e,T=J(),m=w||T,a=te(O,c),b=a.currentTabStopId===m,F=G(c),{onFocusableItemAdd:g,onFocusableItemRemove:R}=a;return s.useEffect(()=>{if(t)return g(),()=>R()},[t,g,R]),d.jsx(_.ItemSlot,{scope:c,id:m,focusable:t,active:E,children:d.jsx(D.span,{tabIndex:b?0:-1,"data-orientation":a.orientation,...C,ref:r,onMouseDown:p(e.onMouseDown,o=>{t?a.onItemFocus(m):o.preventDefault()}),onFocus:p(e.onFocus,()=>a.onItemFocus(m)),onKeyDown:p(e.onKeyDown,o=>{if(o.key==="Tab"&&o.shiftKey){a.onItemShiftTab();return}if(o.target!==o.currentTarget)return;const l=se(o,a.orientation,a.dir);if(l!==void 0){if(o.metaKey||o.ctrlKey||o.altKey||o.shiftKey)return;o.preventDefault();let u=F().filter(i=>i.focusable).map(i=>i.ref.current);if(l==="last")u.reverse();else if(l==="prev"||l==="next"){l==="prev"&&u.reverse();const i=u.indexOf(o.currentTarget);u=a.loop?ce(u,i+1):u.slice(i+1)}setTimeout(()=>M(u))}}),children:typeof v=="function"?v({isCurrentTabStop:b}):v})})});K.displayName=O;var re={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function ne(e,r){return r!=="rtl"?e:e==="ArrowLeft"?"ArrowRight":e==="ArrowRight"?"ArrowLeft":e}function se(e,r,c){const t=ne(e.key,c);if(!(r==="vertical"&&["ArrowLeft","ArrowRight"].includes(t))&&!(r==="horizontal"&&["ArrowUp","ArrowDown"].includes(t)))return re[t]}function M(e,r=!1){const c=document.activeElement;for(const t of e)if(t===c||(t.focus({preventScroll:r}),document.activeElement!==c))return}function ce(e,r){return e.map((c,t)=>e[(r+t)%e.length])}var de=N,me=K;export{me as I,de as R,fe as c};
