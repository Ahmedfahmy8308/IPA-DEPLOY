import{r as a,j as e,b as g,a as p,A as R}from"./index-NEmAdP4c.js";import B from"./DashboardLayout-C2znE-AJ.js";import"./avatar-C1m3Y5hw.js";import"./chevron-down-DWwact5E.js";import"./menu-C604Ulqq.js";import"./house-CQzVKluF.js";import"./settings-BgsgteJR.js";import"./user-BJWe9X2L.js";import"./proxy-YYV9YHxY.js";import"./index-kIO2huDY.js";function J(){const[C,x]=a.useState(null),[F,k]=a.useState(null),[d,f]=a.useState(""),[n,h]=a.useState(""),[w,b]=a.useState(""),[r,l]=a.useState({}),[S,y]=a.useState(!1),[L,m]=a.useState(!1),[u,j]=a.useState(!1),[P,N]=a.useState(!1),[I,v]=a.useState(!0),U=a.useRef(null);a.useEffect(()=>{(async()=>{v(!0);try{const t=await g.get(p+"User/profile");if(t.data.success&&t.data.data){const o=t.data.data;o.profilePictureUrl&&x(R+o.profilePictureUrl)}}catch(t){console.error("Error fetching user profile:",t)}finally{v(!1)}})()},[]);const A=s=>{const t=s.target.files[0];if(t){if(t.size>2*1024*1024){l({...r,image:"Image must be less than 2MB"});return}k(t),x(URL.createObjectURL(t)),l({...r,image:""}),E(t)}},E=async s=>{var o,i;N(!0),m(!1);const t=new FormData;t.append("ProfilePhoto",s);try{const c=await g.put(p+"User/profile/photo",t,{headers:{"Content-Type":"multipart/form-data"}});c.data.success?(m(!0),setTimeout(()=>m(!1),3e3)):l({...r,image:c.data.message||"Failed to upload image"})}catch(c){l({...r,image:((i=(o=c.response)==null?void 0:o.data)==null?void 0:i.message)||"An error occurred while uploading the image"})}finally{N(!1)}},z=()=>{const s={};return d||(s.password="Current password is required"),n?n.length<8&&(s.newPassword="Password must be at least 8 characters"):s.newPassword="New password is required",n!==w&&(s.confirmPassword="Passwords do not match"),l(s),Object.keys(s).length===0},M=async s=>{var t,o;if(s.preventDefault(),y(!1),!!z()){j(!0);try{const i=await g.post(p+"Auth/ChangePass",{oldPassword:d,newPassword:n});y(!0),f(""),h(""),b("")}catch(i){l({...r,submit:((o=(t=i.response)==null?void 0:t.data)==null?void 0:o.message)||"An error occurred while changing the password"})}finally{j(!1)}}};return e.jsx(B,{children:e.jsxs("div",{className:"max-w-md mx-auto p-6 space-y-8 bg-gray-200 rounded-xl shadow-lg",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray",children:"Profile Image"}),e.jsxs("div",{className:"flex flex-col items-center gap-4 sm:flex-row",children:[e.jsxs("div",{className:"relative group",children:[I?e.jsx("div",{className:"w-20 h-20 rounded-full bg-gray-300 flex items-center justify-center",children:e.jsxs("svg",{className:"animate-spin h-8 w-8 text-gray-500",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]})}):e.jsx("img",{src:C||"/default-avatar.png",alt:"Profile",className:"w-20 h-20 rounded-full object-cover border-2 border-gray-600 group-hover:border-blue-500 transition-all duration-300"}),e.jsx("div",{className:"absolute inset-0 rounded-full bg-black bg-opacity-40 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity duration-300",children:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 13a3 3 0 11-6 0 3 3 0 016 0z"})]})})]}),e.jsxs("div",{className:"flex-1 w-full",children:[e.jsxs("label",{className:"flex flex-col items-center px-4 py-2 bg-gray-800 rounded-lg border border-gray-700 cursor-pointer hover:bg-gray-700 transition",children:[e.jsx("span",{className:"text-sm font-medium text-gray-300 mb-1",children:P?"Uploading...":"Choose Image"}),e.jsx("span",{className:"text-xs text-gray-400",children:"PNG, JPG (Max 2MB)"}),e.jsx("input",{type:"file",accept:"image/*",onChange:A,className:"hidden",ref:U,disabled:P})]}),r.image&&e.jsx("p",{className:"mt-1 text-sm text-red-500",children:r.image}),L&&e.jsx("p",{className:"mt-1 text-sm text-green-500",children:"Profile image updated successfully!"})]})]})]}),e.jsxs("form",{onSubmit:M,className:"space-y-5",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray border-b border-gray-800 pb-2",children:"Change Password"}),S&&e.jsx("div",{className:"p-3 bg-green-900 border border-green-700 rounded-lg text-white text-sm",children:"Password changed successfully!"}),r.submit&&e.jsx("div",{className:"p-3 bg-red-900/30 border border-red-700 rounded-lg text-red-400 text-sm",children:r.submit}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray mb-1",children:"Current Password"}),e.jsx("input",{type:"password",value:d,onChange:s=>f(s.target.value),className:`w-full px-4 py-2 rounded-lg bg-gray-400 text-black border ${r.password?"border-red-600":"border-gray-700"} focus:border-blue-500 focus:ring-1 focus:ring-blue-500 outline-none transition`,placeholder:"Enter current password"}),r.password&&e.jsx("p",{className:"mt-1 text-sm text-red-500",children:r.password})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray mb-1",children:"New Password"}),e.jsx("input",{type:"password",value:n,onChange:s=>h(s.target.value),className:`w-full px-4 py-2 rounded-lg bg-gray-400 text-black border ${r.newPassword?"border-red-600":"border-gray-700"} focus:border-blue-500 focus:ring-1 focus:ring-blue-500 outline-none transition`,placeholder:"Enter new password"}),r.newPassword&&e.jsx("p",{className:"mt-1 text-sm text-red-500",children:r.newPassword})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray mb-1",children:"Confirm New Password"}),e.jsx("input",{type:"password",value:w,onChange:s=>b(s.target.value),className:`w-full px-4 py-2 rounded-lg bg-gray-400 text-black border ${r.confirmPassword?"border-red-600":"border-gray-700"} focus:border-blue-500 focus:ring-1 focus:ring-blue-500 outline-none transition`,placeholder:"Confirm new password"}),r.confirmPassword&&e.jsx("p",{className:"mt-1 text-sm text-red-500",children:r.confirmPassword})]}),e.jsx("button",{type:"submit",disabled:u,className:`w-full py-2.5 px-4 rounded-lg bg-blue-600 hover:bg-blue-700 text-white font-medium flex items-center justify-center ${u?"opacity-80 cursor-not-allowed":""} transition`,children:u?e.jsxs(e.Fragment,{children:[e.jsxs("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Loading..."]}):"Change Password"})]})]})})}export{J as default};
