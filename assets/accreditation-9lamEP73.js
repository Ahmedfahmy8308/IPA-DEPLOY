import{c as O,r as i,a as o,A as C,j as e,y as p}from"./index-MCFfI99p.js";import{B as m}from"./button-CwOI2u3d.js";import{C as w,a as $,c as H,b as k,d as Y}from"./card-Bt4J-5pX.js";import{I as b}from"./input-UU4jfSKi.js";import{T as _}from"./textarea-Bsm6WgMq.js";import{T as G,a as J,b as D,c as u,d as K,e as x}from"./table-B_nhSqCF.js";import{B as y}from"./badge-ySf7ZLp2.js";import Q from"./DashboardLayout-Dd50qPA1.js";import{C as V}from"./ConfirmationDialog-DX6FLAuy.js";import{A as I}from"./award-Ct2HnxW3.js";import{P as W}from"./plus-BmgOa7b3.js";import{C as X}from"./calendar-days-CAUdZ4MP.js";import{P as Z}from"./pencil-C-VSZjYD.js";import{T as ee}from"./trash-2-BXfaccw_.js";import"./avatar-DU1t9Qr8.js";import"./chevron-down-CXWDSZLj.js";import"./menu-CaJIzXYd.js";import"./house-CAAiKLfu.js";import"./settings-qNjP71dP.js";import"./user-n4BEbYvd.js";import"./proxy-BUY59ZtG.js";import"./index-SQPNI4UL.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const se=O("Barcode",[["path",{d:"M3 5v14",key:"1nt18q"}],["path",{d:"M8 5v14",key:"1ybrkv"}],["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"M17 5v14",key:"ycjyhj"}],["path",{d:"M21 5v14",key:"nzette"}]]),De=()=>{const[S,f]=i.useState(!1),[g,N]=i.useState(!1),[A,j]=i.useState([]),[a,r]=i.useState({id:null,name:"",description:"",image:null,year:"",code:"",status:"active"}),[h,d]=i.useState(null),[c,l]=i.useState({open:!1,message:"",onConfirm:null}),[ae,te]=i.useState(null),[ie,P]=i.useState(null);i.useEffect(()=>{fetch(o+"Certifications",{credentials:"include"}).then(s=>s.json()).then(s=>{j(s.data.map(t=>({id:t.id,name:t.name,description:t.description,image:C+t.imageUrl,year:new Date(t.dateAcquired).getFullYear(),code:t.certificationId,status:t.isActive?"active":"expired"})))})},[]);const T=async()=>{const s=new FormData;s.append("Name",a.name),s.append("Description",a.description),s.append("DateAcquired",`${a.year}-01-01`),s.append("IsActive",a.status==="active"?"true":"false"),s.append("CertificationId",a.code),a.image&&typeof a.image!="string"&&s.append("Image",a.image);try{g&&a.id?(await fetch(`${o}Certifications/${a.id}`,{method:"PUT",body:s,credentials:"include"}),p.success("Accreditation updated!")):(await fetch(o+"Certifications",{method:"POST",body:s,credentials:"include"}),p.success("Accreditation added!"));const q=await(await fetch(o+"Certifications",{credentials:"include"})).json();j(q.data.map(n=>({id:n.id,name:n.name,description:n.description,image:C+n.imageUrl,year:new Date(n.dateAcquired).getFullYear(),code:n.certificationId,status:n.isActive?"active":"expired"}))),v()}catch{p.error("Failed to save accreditation")}},E=s=>{const t=s.target.files[0];t?(r({...a,image:t}),d(URL.createObjectURL(t))):typeof a.image=="string"?d(a.image):d(null)},B=async s=>{await fetch(`${o}Certifications/${s}`,{method:"DELETE",credentials:"include"}),j(A.filter(t=>t.id!==s))},F=s=>{r({id:s.id,name:s.name,description:s.description,image:s.image,year:s.year,code:s.code,status:s.status}),d(s.image||null),N(!0),f(!0)},v=()=>{r({id:null,name:"",description:"",image:null,year:"",code:"",status:"active"}),d(null),N(!1),f(!1)},U=s=>{switch(s){case"active":return e.jsx(y,{className:"bg-green-100 text-green-800",children:"Active"});case"expired":return e.jsx(y,{variant:"destructive",children:"Expired"});default:return e.jsx(y,{variant:"outline",children:"Unknown"})}},z=()=>{l({open:!0,message:g?"Are you sure you want to update this accreditation?":"Are you sure you want to add this accreditation?",onConfirm:()=>M()})},M=async()=>{l({...c,open:!1}),await T()},R=s=>{P(s),l({open:!0,message:"Are you sure you want to delete this accreditation?",onConfirm:()=>L(s)})},L=async s=>{l({...c,open:!1}),await B(s),p.success("Accreditation deleted!")};return e.jsxs(Q,{children:[e.jsxs("div",{className:"space-y-6",children:[e.jsxs(w,{children:[e.jsx($,{className:"border-b",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs(H,{className:"text-xl font-semibold flex items-center gap-2",children:[e.jsx(I,{className:"w-5 h-5"}),"Accreditation Management"]}),e.jsxs(m,{onClick:()=>{v(),f(!0)},className:"gap-2",children:[e.jsx(W,{size:16}),"Add Accreditation"]})]})}),S&&e.jsxs(k,{className:"pt-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Accreditation Name"}),e.jsx(b,{placeholder:"ISO 9001 Certification",value:a.name,onChange:s=>r({...a,name:s.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Description"}),e.jsx(_,{placeholder:"Describe the accreditation...",value:a.description,onChange:s=>r({...a,description:s.target.value}),rows:4})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Year"}),e.jsx(b,{type:"number",placeholder:"2023",value:a.year,onChange:s=>r({...a,year:s.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Status"}),e.jsxs("select",{value:a.status,onChange:s=>r({...a,status:s.target.value}),className:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",children:[e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"expired",children:"Expired"})]})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Accreditation Code"}),e.jsx(b,{placeholder:"ACC-2023-ISO",value:a.code,onChange:s=>r({...a,code:s.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Accreditation Image"}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"border rounded-md p-2 w-full",children:e.jsx("input",{type:"file",onChange:E,className:"w-full text-sm",accept:"image/*"})}),h&&e.jsx("img",{src:h,alt:"Preview",className:"w-16 h-16 rounded-md object-cover border"})]})]}),h&&e.jsx("div",{className:"flex justify-center",children:e.jsx("img",{src:h,alt:"Accreditation Preview",className:"max-w-full h-32 object-contain border rounded"})})]})]}),e.jsxs(Y,{className:"flex justify-end gap-2 pt-6 border-t",children:[e.jsx(m,{variant:"outline",onClick:v,children:"Cancel"}),e.jsx(m,{onClick:z,className:"bg-blue-600 hover:bg-blue-700",children:g?"Update Accreditation":"Add Accreditation"})]})]})]}),e.jsx(w,{children:e.jsx(k,{className:"p-0",children:e.jsxs(G,{children:[e.jsx(J,{children:e.jsxs(D,{children:[e.jsx(u,{className:"w-[120px]",children:"Image"}),e.jsx(u,{children:"Accreditation"}),e.jsx(u,{children:"Details"}),e.jsx(u,{className:"text-center",children:"Status"}),e.jsx(u,{className:"text-right",children:"Actions"})]})}),e.jsx(K,{children:A.map(s=>e.jsxs(D,{children:[e.jsx(x,{children:s.image?e.jsx("img",{src:s.image,alt:s.name,className:"w-12 h-12 rounded object-cover border"}):e.jsx("div",{className:"w-12 h-12 rounded border flex items-center justify-center bg-gray-50",children:e.jsx(I,{className:"w-5 h-5 text-gray-400"})})}),e.jsxs(x,{children:[e.jsx("div",{className:"font-medium",children:s.name}),e.jsx("div",{className:"text-sm text-gray-500 line-clamp-2",children:s.description})]}),e.jsx(x,{children:e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(X,{size:14,className:"text-gray-500"}),s.year]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(se,{size:14,className:"text-gray-500"}),s.code]})]})}),e.jsx(x,{className:"text-center",children:U(s.status)}),e.jsx(x,{className:"text-right",children:e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsxs(m,{variant:"outline",size:"sm",onClick:()=>F(s),children:[e.jsx(Z,{size:14,className:"mr-1"}),"Edit"]}),e.jsxs(m,{variant:"destructive",size:"sm",onClick:()=>R(s.id),children:[e.jsx(ee,{size:14,className:"mr-1"}),"Delete"]})]})})]},s.id))})]})})})]}),c.open&&e.jsx(V,{message:c.message,onConfirm:c.onConfirm,onCancel:()=>l({...c,open:!1})})]})};export{De as default};
