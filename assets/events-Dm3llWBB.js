import{r as c,j as e,a as N,y as u}from"./index-DSbC69U8.js";import{B as p}from"./button-BanH1mNW.js";import{C as E,a as C,c as S,b as k,d as ee}from"./card-DdSnDD3U.js";import{I as h}from"./input-CwdNmczo.js";import{T as se}from"./textarea-Crxb8bCp.js";import{T as M,a as R,b as g,c as o,d as B,e as d}from"./table-BXYXOQvI.js";import{B as T}from"./badge-CivnA1J2.js";import ae from"./DashboardLayout-CgZemHwQ.js";import{C as te}from"./ConfirmationDialog-DPAgyip4.js";import{P as ie}from"./plus-CXEFMUXs.js";import{C as O}from"./calendar-DhGQe5Ge.js";import{C as re}from"./clock-D2uEA6jS.js";import{M as H}from"./map-pin-CFTQIxnM.js";import{U as Y}from"./users-BomgL9ti.js";import{P as _}from"./pencil-CN1IfN06.js";import{T as G}from"./trash-2-BV8i9BA9.js";import"./avatar-0mFXGbEo.js";import"./chevron-down-aOoY2hDg.js";import"./menu-BwaHMtMR.js";import"./house-Sgp_2irf.js";import"./settings-CT5cNo8j.js";import"./user-Ik_QhwCc.js";import"./proxy-Cis1aWOO.js";import"./index-CPMrXLRy.js";async function ne(){try{const a=await fetch(`${N}Events`);if(!a.ok)throw new Error("Network response was not ok");return(await a.json()).data}catch(a){throw new Error("Failed to fetch events: "+a.message)}}async function le(a){const i=new FormData;i.append("Name",a.name),i.append("Description",a.description),i.append("Location",a.location),i.append("Image",a.image),i.append("StartDate",a.startDate),i.append("EndDate",a.endDate),i.append("Status",a.status),i.append("Capacity",a.capacity);const r=await fetch(`${N}Events`,{method:"POST",credentials:"include",body:i});if(!r.ok)throw new Error("Network response was not ok");return(await r.json()).data}async function ce(a){const i=new FormData;a.name&&i.append("Name",a.name),a.description&&i.append("Description",a.description),a.location&&i.append("Location",a.location),a.image&&i.append("Image",a.image),a.startDate&&i.append("StartDate",a.startDate),a.endDate&&i.append("EndDate",a.endDate),a.status&&i.append("Status",a.status),a.capacity&&i.append("Capacity",a.capacity);const r=await fetch(`${N}Events/${a.id}`,{method:"PUT",credentials:"include",body:i});if(!r.ok)throw new Error("Network response was not ok");return(await r.json()).data}async function oe(a){const i=await fetch(`${N}Events/${a}`,{method:"DELETE",credentials:"include"});if(!i.ok)throw new Error("Network response was not ok");return(await i.json()).data}const Le=()=>{const[a,i]=c.useState(!1),[r,j]=c.useState([]),[z,m]=c.useState(!1),[F,x]=c.useState(""),[J,y]=c.useState(!1),[K,U]=c.useState(null),[v,P]=c.useState(!0),[t,n]=c.useState({id:void 0,name:"",description:"",image:null,isSpecial:!1,location:"",startDate:"",endDate:"",status:"",capacity:""}),[b,L]=c.useState(!1);c.useEffect(()=>{D()},[]);const D=async()=>{m(!0),x("");try{const s=await ne();j(s||[])}catch{x("Failed to load events")}finally{m(!1)}},Q=async()=>{m(!0),x("");try{const s={name:t.name,description:t.description,location:t.location,image:t.image,startDate:t.startDate?new Date(t.startDate).toISOString():"",endDate:t.endDate?new Date(t.endDate).toISOString():"",status:t.status,capacity:t.capacity};if(!b&&!t.image){x("Event image is required."),m(!1);return}b?(await ce({...s,id:t.id}),u.success("Event updated successfully!")):(await le(s),u.success("Event added successfully!")),await D(),w()}catch{x("Failed to save event"),u.error("Failed to save event")}finally{m(!1)}},V=s=>{const l=s.target.files[0];l&&n({...t,image:l})},$=s=>{U(s),y(!0)},W=async()=>{m(!0),x("");try{await oe(K),await D(),u.success("Event deleted successfully!")}catch{x("Failed to delete event"),u.error("Failed to delete event")}finally{y(!1),U(null),m(!1)}},A=s=>{if(!s)return"";const l=new Date(s),f=Z=>Z.toString().padStart(2,"0");return`${l.getFullYear()}-${f(l.getMonth()+1)}-${f(l.getDate())}T${f(l.getHours())}:${f(l.getMinutes())}`},I=s=>{n({id:s.id,name:s.name,description:s.description,image:null,isSpecial:s.isFeaturedEvent,location:s.location,startDate:A(s.startDate),endDate:A(s.endDate),status:s.status,capacity:s.capacity}),L(!0),i(!0)},w=()=>{n({id:void 0,name:"",description:"",image:null,isSpecial:!1,location:"",startDate:"",endDate:"",status:"",capacity:""}),L(!1),i(!1)},q=s=>{if(!s)return"";const l={year:"numeric",month:"short",day:"numeric"};return new Date(s).toLocaleDateString("en-US",l)},X=s=>{s.preventDefault(),Q()};return e.jsxs(ae,{children:[e.jsxs("div",{className:"space-y-6",children:[F&&e.jsx("div",{className:"bg-red-100 text-red-700 px-4 py-2 rounded mb-4 border border-red-300",children:F}),e.jsxs("div",{className:"flex gap-4 items-center mb-2",children:[e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:v,onChange:()=>P(!0)}),e.jsx("span",{children:"Upcoming Events"})]}),e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:!v,onChange:()=>P(!1)}),e.jsx("span",{children:"Past Events"})]})]}),e.jsxs(E,{children:[e.jsx(C,{className:"border-b",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx(S,{className:"text-xl font-semibold",children:"Events Management"}),e.jsxs(p,{onClick:()=>{w(),i(!0)},className:"gap-2",children:[e.jsx(ie,{size:16}),"Add New Event"]})]})}),a&&e.jsx(k,{className:"pt-6",children:e.jsxs("form",{onSubmit:X,children:[e.jsx("input",{type:"hidden",value:t.id||""}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Event Name"}),e.jsx(h,{required:!0,placeholder:"Tech Conference 2025",value:t.name,onChange:s=>n({...t,name:s.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Location"}),e.jsx(h,{required:!0,placeholder:"Cairo International Conference Center",value:t.location,onChange:s=>n({...t,location:s.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Start Date"}),e.jsx(h,{required:!0,type:"datetime-local",value:t.startDate,onChange:s=>n({...t,startDate:s.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"End Date"}),e.jsx(h,{required:!0,type:"datetime-local",value:t.endDate,onChange:s=>n({...t,endDate:s.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Event Status"}),e.jsxs("select",{required:!0,className:"form-select w-full border rounded-md p-2",value:t.status,onChange:s=>n({...t,status:s.target.value}),children:[e.jsx("option",{value:"0",children:"Upcoming"}),e.jsx("option",{value:"1",children:"Ongoing"}),e.jsx("option",{value:"2",children:"Completed"}),e.jsx("option",{value:"3",children:"Cancelled"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Capacity"}),e.jsx(h,{type:"number",value:t.capacity,onChange:s=>n({...t,capacity:s.target.value})})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Event Image"}),e.jsx("input",{type:"file",accept:"image/*",onChange:V,className:"w-full border rounded-md p-2 text-sm"}),e.jsx("small",{className:"text-gray-500",children:"Recommended size: 800x450 pixels"}),t.image&&e.jsx("div",{className:"mt-2",children:e.jsx("img",{src:typeof t.image=="string"?t.image:URL.createObjectURL(t.image),alt:"Preview",className:"w-32 h-20 object-cover rounded-md border"})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Description"}),e.jsx(se,{required:!0,placeholder:"Describe your event...",value:t.description,onChange:s=>n({...t,description:s.target.value}),rows:4})]})]})]}),e.jsxs(ee,{className:"flex justify-end gap-2 pt-6 border-t",children:[e.jsx(p,{variant:"outline",onClick:w,children:"Cancel"}),e.jsx(p,{type:"submit",className:"bg-blue-600 hover:bg-blue-700",children:b?"Update Event":"Create Event"})]})]})})]}),v?e.jsxs(E,{children:[e.jsx(C,{children:e.jsx(S,{className:"text-lg",children:"Upcoming Events"})}),e.jsx(k,{children:e.jsxs(M,{children:[e.jsx(R,{children:e.jsxs(g,{children:[e.jsx(o,{className:"w-[200px]",children:"Event"}),e.jsx(o,{children:"Details"}),e.jsx(o,{className:"text-center",children:"Status"}),e.jsx(o,{className:"text-right",children:"Actions"})]})}),e.jsx(B,{children:r.filter(s=>s.status!==2).map(s=>e.jsxs(g,{children:[e.jsxs(d,{children:[e.jsx("div",{className:"font-medium",children:s.name}),e.jsx("div",{className:"text-sm text-gray-500 line-clamp-2",children:s.description})]}),e.jsx(d,{children:e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(O,{size:14,className:"text-gray-500"}),q(s.startDate)]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(re,{size:14,className:"text-gray-500"}),s.startDate]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(H,{size:14,className:"text-gray-500"}),s.location]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(Y,{size:14,className:"text-gray-500"}),s.capacity," attendees"]})]})}),e.jsx(d,{className:"text-center",children:s.isSpecial?e.jsx(T,{variant:"default",className:"bg-purple-100 text-purple-800",children:"Special"}):e.jsx(T,{variant:"outline",children:"Regular"})}),e.jsx(d,{className:"text-right",children:e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsxs(p,{variant:"outline",size:"sm",onClick:()=>I(s),children:[e.jsx(_,{size:14,className:"mr-1"}),"Edit"]}),e.jsxs(p,{variant:"destructive",size:"sm",onClick:()=>$(s.id),children:[e.jsx(G,{size:14,className:"mr-1"}),"Delete"]})]})})]},s.id))})]})})]}):e.jsxs(E,{children:[e.jsx(C,{children:e.jsx(S,{className:"text-lg",children:"Past Events"})}),e.jsx(k,{children:e.jsxs(M,{children:[e.jsx(R,{children:e.jsxs(g,{children:[e.jsx(o,{className:"w-[200px]",children:"Event"}),e.jsx(o,{children:"Details"}),e.jsx(o,{className:"text-center",children:"Status"}),e.jsx(o,{className:"text-right",children:"Actions"})]})}),e.jsx(B,{children:r.filter(s=>s.status===2).map(s=>e.jsxs(g,{className:"bg-gray-50",children:[e.jsxs(d,{children:[e.jsx("div",{className:"font-medium",children:s.name}),e.jsx("div",{className:"text-sm text-gray-500 line-clamp-2",children:s.description})]}),e.jsx(d,{children:e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(O,{size:14,className:"text-gray-500"}),q(s.startDate)]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(H,{size:14,className:"text-gray-500"}),s.location]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(Y,{size:14,className:"text-gray-500"}),s.capacity," attendees"]})]})}),e.jsx(d,{className:"text-center",children:e.jsx(T,{variant:"secondary",children:"Completed"})}),e.jsx(d,{className:"text-right",children:e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsxs(p,{variant:"outline",size:"sm",onClick:()=>I(s),children:[e.jsx(_,{size:14,className:"mr-1"}),"Edit"]}),e.jsxs(p,{variant:"destructive",size:"sm",onClick:()=>$(s.id),children:[e.jsx(G,{size:14,className:"mr-1"}),"Delete"]})]})})]},s.id))})]})})]})]}),J&&e.jsx(te,{message:"Are you sure you want to delete this event?",onConfirm:W,onCancel:()=>y(!1)})]})};export{Le as default};
