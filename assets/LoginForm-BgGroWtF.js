import{r as o,e as j,j as e,A as N,L as x,a as i,y as t,f as v}from"./index-BV1Skg7F.js";/* empty css                      */function A(){const[l,p]=o.useState(""),[c,h]=o.useState(""),[d,u]=o.useState(!1),[m,f]=o.useState(null),g=j();o.useEffect(()=>{},[g]);const y=async()=>{try{const a=await fetch(i+"GeneralInfo");if(!a.ok)throw new Error("Failed to fetch logo");const s=await a.json();f(s.data.headerLogoUrl)}catch(a){console.error("Error fetching logo:",a),f(null)}};o.useEffect(()=>{y()},[]);const b=async a=>{try{const s=await fetch(`${i}auth/login`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a),credentials:"include"}),r=await s.json();if(s.ok&&r&&r.success&&r.data){const n={userId:r.data.userId,username:r.data.username,email:r.data.email,expiresAt:r.data.expiresAt,role:r.data.role,firstName:r.data.firstName};return localStorage.setItem("userData",JSON.stringify({...n,expiresAt:r.data.expiresAt})),n}throw new Error((r==null?void 0:r.message)||"Invalid email or password")}catch(s){throw console.error("Login error:",s),localStorage.removeItem("userData"),s}},w=async a=>{a.preventDefault(),u(!0);try{const s=await b({email:l,password:c});console.log("Login success, userData:",s),t.success("Login successful!"),g("/"),window.location.reload()}catch(s){if(console.error("Login error caught in LoginForm:",s),v.isAxiosError(s))if(s.response)if(s.response.status===400){const r=s.response.data;typeof r.message=="string"&&r.message.includes("Please confirm your email first")?t.error(e.jsxs("div",{children:["Please confirm your email first."," ",e.jsx("button",{onClick:async()=>{try{(await fetch(`${i}Auth/resend-confirmation-link?email=${encodeURIComponent(l)}`,{method:"POST",headers:{accept:"*/*"},credentials:"include"})).ok?t.success("Confirmation email resent successfully!"):t.error("Failed to resend confirmation email.")}catch{t.error("An error occurred while resending the email.")}},className:"text-blue-500 underline",children:"Resend Confirmation Email"})]}),{autoClose:!1}):t.error(r.message||"Invalid credentials")}else s.response.status===401?t.error("Invalid email or password"):t.error("Login failed. Please try again later.");else s.request?t.error("Login failed. No response from server. Please try again later."):t.error("Login failed. Please check your connection and try again.");else t.error("An unexpected error occurred. Please try again later.")}finally{u(!1)}};return e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-100 py-12 px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"w-full max-w-md bg-white p-10 rounded-2xl shadow-2xl",children:[e.jsxs("div",{className:"text-center mb-8",children:[m?e.jsx("img",{src:`${N}/${m}`,alt:"Logo",className:"mx-auto h-14 w-auto mb-6"}):e.jsx("div",{className:"h-14 w-14 mx-auto mb-6 bg-gray-200 rounded-full animate-pulse"}),e.jsx("h2",{className:"text-3xl font-bold text-gray-800",children:"Welcome Back"}),e.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"Login to your account"})]}),e.jsxs("form",{onSubmit:w,className:"space-y-6",children:[e.jsxs("div",{className:"relative",children:[e.jsx("i",{className:"fas fa-envelope absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"}),e.jsx("input",{type:"email",required:!0,value:l,onChange:a=>p(a.target.value),className:"w-full pl-10 pr-3 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm",placeholder:"Email Address"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("i",{className:"fas fa-lock absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"}),e.jsx("input",{type:"password",required:!0,value:c,onChange:a=>h(a.target.value),className:"w-full pl-10 pr-3 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm",placeholder:"Password"})]}),e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsxs("label",{className:"flex items-center text-gray-600",children:[e.jsx("input",{type:"checkbox",className:"h-4 w-4 text-blue-600 border-gray-300 rounded mr-2"}),"Remember me"]}),e.jsx(x,{to:"/forgot-password",className:"text-blue-600 hover:underline",children:"Forgot password?"})]}),e.jsx("button",{type:"submit",disabled:d,className:"w-full bg-blue-600 hover:bg-blue-700 text-white font-semibold py-3 rounded-xl transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed",children:d?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"inline-block animate-spin border-t-2 border-white border-2 rounded-full h-4 w-4 mr-2"}),"Logging in..."]}):"Login"}),e.jsxs("p",{className:"text-center text-sm text-gray-600",children:["Don't have an account?"," ",e.jsx(x,{to:"/register",className:"text-blue-600 font-medium hover:underline",children:"Sign up"})]})]})]})})}export{A as default};
