import{c as qe,r,M as Qe,j as e,P as Xe,Q as U,T as _,Z as Ye,m as Z,y,a as x,A as ae}from"./index-NEmAdP4c.js";import{C as te}from"./ConfirmationDialog-Bys6WL_d.js";import{B as j}from"./button-u1Kq1CWc.js";import{I as se}from"./input-DzCkpagy.js";import{C as z,a as O,c as B,b as H,d as re}from"./card-BWIjpHft.js";import{T as le,a as ie,b as E,c as N,d as ne,e as v}from"./table-BcMclRnd.js";import ea from"./DashboardLayout-C2znE-AJ.js";import{c as pe,R as aa,I as ta}from"./index-DstxVblb.js";import{u as sa}from"./index-DaYDwrWf.js";import{u as ra}from"./Combination-CmA9DQqZ.js";import{S as de,a as oe,b as ce,c as me,d as K}from"./select-tLDjxXyV.js";import{I as ue}from"./image-BqFp-W7C.js";import{P as ge}from"./plus-Br_yb5mZ.js";import{P as he}from"./pencil-CwxbKGdg.js";import{T as ye}from"./trash-2-uj6zs77s.js";import{V as fe}from"./video-_13odzru.js";import"./avatar-C1m3Y5hw.js";import"./chevron-down-DWwact5E.js";import"./menu-C604Ulqq.js";import"./house-CQzVKluF.js";import"./settings-BgsgteJR.js";import"./user-BJWe9X2L.js";import"./proxy-YYV9YHxY.js";import"./index-kIO2huDY.js";import"./tslib.es6-BUas5LQb.js";import"./index-D8xAM0Gb.js";import"./check-CxY4R4o5.js";import"./chevron-up-BBi1FSAx.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const la=qe("Folder",[["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]]);var L="Tabs",[ia,Ua]=Xe(L,[pe]),xe=pe(),[na,q]=ia(L),je=r.forwardRef((s,n)=>{const{__scopeTabs:o,value:d,onValueChange:m,defaultValue:u,orientation:i="horizontal",dir:g,activationMode:f="automatic",...p}=s,h=sa(g),[c,l]=Qe({prop:d,onChange:m,defaultProp:u??"",caller:L});return e.jsx(na,{scope:o,baseId:ra(),value:c,onValueChange:l,orientation:i,dir:h,activationMode:f,children:e.jsx(U.div,{dir:h,"data-orientation":i,...p,ref:n})})});je.displayName=L;var ve="TabsList",be=r.forwardRef((s,n)=>{const{__scopeTabs:o,loop:d=!0,...m}=s,u=q(ve,o),i=xe(o);return e.jsx(aa,{asChild:!0,...i,orientation:u.orientation,dir:u.dir,loop:d,children:e.jsx(U.div,{role:"tablist","aria-orientation":u.orientation,...m,ref:n})})});be.displayName=ve;var Ce="TabsTrigger",Ne=r.forwardRef((s,n)=>{const{__scopeTabs:o,value:d,disabled:m=!1,...u}=s,i=q(Ce,o),g=xe(o),f=Ie(i.baseId,d),p=Se(i.baseId,d),h=d===i.value;return e.jsx(ta,{asChild:!0,...g,focusable:!m,active:h,children:e.jsx(U.button,{type:"button",role:"tab","aria-selected":h,"aria-controls":p,"data-state":h?"active":"inactive","data-disabled":m?"":void 0,disabled:m,id:f,...u,ref:n,onMouseDown:_(s.onMouseDown,c=>{!m&&c.button===0&&c.ctrlKey===!1?i.onValueChange(d):c.preventDefault()}),onKeyDown:_(s.onKeyDown,c=>{[" ","Enter"].includes(c.key)&&i.onValueChange(d)}),onFocus:_(s.onFocus,()=>{const c=i.activationMode!=="manual";!h&&!m&&c&&i.onValueChange(d)})})})});Ne.displayName=Ce;var we="TabsContent",Te=r.forwardRef((s,n)=>{const{__scopeTabs:o,value:d,forceMount:m,children:u,...i}=s,g=q(we,o),f=Ie(g.baseId,d),p=Se(g.baseId,d),h=d===g.value,c=r.useRef(h);return r.useEffect(()=>{const l=requestAnimationFrame(()=>c.current=!1);return()=>cancelAnimationFrame(l)},[]),e.jsx(Ye,{present:m||h,children:({present:l})=>e.jsx(U.div,{"data-state":h?"active":"inactive","data-orientation":g.orientation,role:"tabpanel","aria-labelledby":f,hidden:!l,id:p,tabIndex:0,...i,ref:n,style:{...s.style,animationDuration:c.current?"0s":void 0},children:l&&u})})});Te.displayName=we;function Ie(s,n){return`${s}-trigger-${n}`}function Se(s,n){return`${s}-content-${n}`}var da=je,Me=be,Ee=Ne,Ae=Te;const oa=da,ke=r.forwardRef(({className:s,...n},o)=>e.jsx(Me,{ref:o,className:Z("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",s),...n}));ke.displayName=Me.displayName;const J=r.forwardRef(({className:s,...n},o)=>e.jsx(Ee,{ref:o,className:Z("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",s),...n}));J.displayName=Ee.displayName;const W=r.forwardRef(({className:s,...n},o)=>e.jsx(Ae,{ref:o,className:Z("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",s),...n}));W.displayName=Ae.displayName;const La=()=>{const[s,n]=r.useState([]),[o,d]=r.useState(!1),[m,u]=r.useState({name:""}),[i,g]=r.useState(null),[f,p]=r.useState([]),[h,c]=r.useState(!1),[l,A]=r.useState({name:"",type:"image",url:null,categoryId:""}),[b,Q]=r.useState(null),[I,k]=r.useState(""),[Fe,X]=r.useState(!0),[Y,S]=r.useState(""),[De,w]=r.useState(!1),[F,P]=r.useState(null),[ee,$]=r.useState(null),[R,G]=r.useState(null),[M,D]=r.useState(null),Pe=a=>{const t=a.target.files&&a.target.files[0];t&&(G(t),k(URL.createObjectURL(t)))};r.useEffect(()=>{(async()=>{X(!0),S("");try{const[t,C]=await Promise.all([fetch(`${x}Gallery/get-all-category`,{credentials:"include"}),fetch(`${x}Gallery/get-all-gallery`,{credentials:"include"})]);if(!t.ok||!C.ok)throw new Error("Failed to fetch gallery data");const Je=await t.json(),We=await C.json();n(Je.data),p(We.data.map(T=>{const Ze=T.fileUrl.startsWith("http")?T.fileUrl:ae+T.fileUrl;return{id:T.id,name:T.name,type:T.type===0?"image":"video",url:Ze,categoryId:T.galleryCategoryId}}))}catch{S("Could not load gallery data")}finally{X(!1)}})()},[]);const $e=a=>{u({name:a.name}),g(a.id),d(!0)},Re=()=>{D({type:i?"edit-category":"add-category"})},Ge=async()=>{try{if(i){if(!(await fetch(`${x}Gallery/edit-gallery-category/${i}`,{method:"PUT",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({name:m.name})})).ok)throw new Error("Failed to update category");y.success("Category updated successfully")}else{if(!(await fetch(`${x}Gallery/add-gallery-category`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({name:m.name})})).ok)throw new Error("Failed to add category");y.success("Category added successfully")}const a=await fetch(`${x}Gallery/get-all-category`,{credentials:"include"}).then(t=>t.json());n(a.data),u({name:""}),g(null),d(!1)}catch{S(i?"Could not update category":"Could not add category"),y.error(i?"Could not update category":"Could not add category")}finally{D(null)}},Ue=a=>{P(a),$("category"),w(!0)},Le=async()=>{try{if(!(await fetch(`${x}Gallery/delete-gallery-category/${F}`,{method:"DELETE",credentials:"include"})).ok)throw new Error("Failed to delete category");n(s.filter(t=>t.id!==F)),p(f.map(t=>t.categoryId===F?{...t,categoryId:null}:t)),w(!1),P(null),$(null),y.success("Category deleted successfully")}catch{S("Could not delete category"),w(!1),y.error("Could not delete category")}},Ve=a=>{A({name:a.name,type:a.type,url:a.url,categoryId:a.categoryId}),k(a.url||""),G(null),Q(a.id),c(!0)},_e=a=>{A({...l,type:a}),k(""),G(null)},ze=()=>{D({type:b?"edit-media":"add-media"})},Oe=async()=>{try{if(b){const t=new FormData;if(t.append("Id",b.toString()),t.append("Name",l.name),t.append("Type",l.type==="image"?"0":"1"),t.append("GalleryCategoryId",l.categoryId.toString()),R&&t.append("File",R),!(await fetch(`${x}Gallery/edit-gallery-file/${b}`,{method:"PUT",credentials:"include",body:t})).ok)throw new Error("Failed to update media");y.success("Media updated successfully")}else{const t=new FormData;if(t.append("Name",l.name),t.append("Type",l.type==="image"?"0":"1"),t.append("GalleryCategoryId",l.categoryId.toString()),R&&t.append("File",R),!(await fetch(`${x}Gallery/add-gallery-file`,{method:"POST",credentials:"include",body:t})).ok)throw new Error("Failed to add media");y.success("Media added successfully")}const a=await fetch(`${x}Gallery/get-all-gallery`,{credentials:"include"}).then(t=>t.json());p(a.data.map(t=>{const C=t.fileUrl.startsWith("http")?t.fileUrl:ae+t.fileUrl;return{id:t.id,name:t.name,type:t.type===0?"image":"video",url:C,categoryId:t.galleryCategoryId}})),V()}catch{S(b?"Could not update media":"Could not add media"),y.error(b?"Could not update media":"Could not add media")}finally{D(null)}},Be=a=>{P(a),$("media"),w(!0)},He=async()=>{try{if(!(await fetch(`${x}Gallery/delete-gallery-file/${F}`,{method:"DELETE",credentials:"include"})).ok)throw new Error("Failed to delete media");p(f.filter(t=>t.id!==F)),w(!1),P(null),$(null),y.success("Media deleted successfully")}catch{S("Could not delete media"),w(!1),y.error("Could not delete media")}},V=()=>{A({name:"",type:"image",url:null,categoryId:""}),k(""),Q(null),c(!1)},Ke=()=>{V(),G(null),k(""),c(!0)};return e.jsx(ea,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs(z,{children:[e.jsx(O,{children:e.jsx(B,{className:"text-xl",children:"Gallery Management"})}),e.jsx(H,{children:Fe?e.jsx("div",{children:"Loading..."}):Y?e.jsx("div",{className:"text-red-500",children:Y}):e.jsxs(oa,{defaultValue:"categories",className:"w-full",children:[e.jsxs(ke,{children:[e.jsxs(J,{value:"categories",children:[e.jsx(la,{className:"w-4 h-4 mr-2"}),"Categories"]}),e.jsxs(J,{value:"media",children:[e.jsx(ue,{className:"w-4 h-4 mr-2"}),"Media"]})]}),e.jsx(W,{value:"categories",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex justify-end",children:e.jsxs(j,{onClick:()=>{u({name:""}),g(null),d(!0)},className:"gap-2",children:[e.jsx(ge,{size:16}),"Add Category"]})}),o&&e.jsxs(z,{className:"mb-6",children:[e.jsx(O,{children:e.jsx(B,{className:"text-lg",children:i?"Edit Category":"Add New Category"})}),e.jsx(H,{children:e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Category Name"}),e.jsx(se,{placeholder:"Enter category name",value:m.name,onChange:a=>u({name:a.target.value})})]})})}),e.jsxs(re,{className:"flex justify-end gap-2 border-t pt-4",children:[e.jsx(j,{variant:"outline",onClick:()=>{d(!1),g(null)},children:"Cancel"}),e.jsx(j,{onClick:Re,className:"bg-blue-600 hover:bg-blue-700",children:i?"Update Category":"Add Category"})]})]}),e.jsxs(le,{children:[e.jsx(ie,{children:e.jsxs(E,{children:[e.jsx(N,{className:"w-[100px]",children:"ID"}),e.jsx(N,{children:"Category Name"}),e.jsx(N,{className:"text-right",children:"Actions"})]})}),e.jsx(ne,{children:s.length>0?s.map(a=>e.jsxs(E,{children:[e.jsx(v,{children:a.id}),e.jsx(v,{className:"font-medium",children:a.name}),e.jsx(v,{className:"text-right",children:e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsxs(j,{variant:"outline",size:"sm",onClick:()=>$e(a),children:[e.jsx(he,{size:14,className:"mr-1"}),"Edit"]}),e.jsxs(j,{variant:"destructive",size:"sm",onClick:()=>Ue(a.id),children:[e.jsx(ye,{size:14,className:"mr-1"}),"Delete"]})]})})]},a.id)):e.jsx(E,{children:e.jsx(v,{colSpan:3,className:"text-center py-8 text-gray-500",children:"No categories found. Add your first category."})})})]})]})}),e.jsx(W,{value:"media",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex justify-end",children:e.jsxs(j,{onClick:Ke,className:"gap-2",children:[e.jsx(ge,{size:16}),"Add Media"]})}),h&&e.jsxs(z,{className:"mb-6",children:[e.jsx(O,{children:e.jsx(B,{className:"text-lg",children:b?"Edit Media":"Add New Media"})}),e.jsx(H,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Media Name"}),e.jsx(se,{placeholder:"Enter media name",value:l.name,onChange:a=>A({...l,name:a.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Media Type"}),e.jsxs(de,{value:l.type,onValueChange:_e,children:[e.jsx(oe,{children:e.jsx(ce,{placeholder:"Select media type"})}),e.jsxs(me,{children:[e.jsx(K,{value:"image",children:"Image"}),e.jsx(K,{value:"video",children:"Video"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Category"}),e.jsxs(de,{value:l.categoryId.toString(),onValueChange:a=>A({...l,categoryId:parseInt(a)}),children:[e.jsx(oe,{children:e.jsx(ce,{placeholder:"Select category"})}),e.jsx(me,{children:s.map(a=>e.jsx(K,{value:a.id.toString(),children:a.name},a.id))})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:l.type==="image"?"Upload Image":"Upload Video"}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"border rounded-md p-2 w-full",children:e.jsx("input",{type:"file",onChange:Pe,className:"w-full text-sm",accept:l.type==="image"?"image/*":"video/*"})}),I&&(l.type==="image"?e.jsx("img",{src:I,alt:"Preview",className:"w-16 h-16 rounded-md object-cover border"}):e.jsx("video",{src:I,className:"w-16 h-16 rounded-md object-cover border",controls:!0}))]})]}),I&&e.jsx("div",{className:"flex justify-center",children:l.type==="image"?e.jsx("img",{src:I,alt:"Media Preview",className:"max-w-full h-48 object-contain border rounded"}):e.jsx("video",{src:I,className:"max-w-full h-48 border rounded",controls:!0})})]})]})}),e.jsxs(re,{className:"flex justify-end gap-2 border-t pt-4",children:[e.jsx(j,{variant:"outline",onClick:V,children:"Cancel"}),e.jsx(j,{onClick:ze,className:"bg-blue-600 hover:bg-blue-700",children:b?"Update Media":"Add Media"})]})]}),e.jsxs(le,{children:[e.jsx(ie,{children:e.jsxs(E,{children:[e.jsx(N,{className:"w-[120px]",children:"Preview"}),e.jsx(N,{children:"Name"}),e.jsx(N,{children:"Type"}),e.jsx(N,{children:"Category"}),e.jsx(N,{className:"text-right",children:"Actions"})]})}),e.jsx(ne,{children:f.length>0?f.map(a=>{var t;return e.jsxs(E,{children:[e.jsx(v,{children:a.url?a.type==="image"?e.jsx("img",{src:a.url,alt:a.name,className:"w-12 h-12 rounded object-cover border"}):e.jsx("div",{className:"w-12 h-12 rounded bg-gray-100 flex items-center justify-center",children:e.jsx(fe,{className:"w-5 h-5 text-gray-500"})}):e.jsx("div",{className:"w-12 h-12 rounded bg-gray-100 flex items-center justify-center",children:a.type==="image"?e.jsx(ue,{className:"w-5 h-5 text-gray-500"}):e.jsx(fe,{className:"w-5 h-5 text-gray-500"})})}),e.jsx(v,{className:"font-medium",children:a.name}),e.jsx(v,{children:e.jsx("span",{className:`px-2 py-1 rounded text-xs ${a.type==="image"?"bg-blue-100 text-blue-800":"bg-purple-100 text-purple-800"}`,children:a.type})}),e.jsx(v,{children:((t=s.find(C=>C.id===a.categoryId))==null?void 0:t.name)||"Uncategorized"}),e.jsx(v,{className:"text-right",children:e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsxs(j,{variant:"outline",size:"sm",onClick:()=>Ve(a),children:[e.jsx(he,{size:14,className:"mr-1"}),"Edit"]}),e.jsxs(j,{variant:"destructive",size:"sm",onClick:()=>Be(a.id),children:[e.jsx(ye,{size:14,className:"mr-1"}),"Delete"]})]})})]},a.id)}):e.jsx(E,{children:e.jsx(v,{colSpan:5,className:"text-center py-8 text-gray-500",children:"No media found. Add your first media item."})})})]})]})})]})})]}),De&&e.jsx(te,{message:`Are you sure you want to delete this ${ee==="category"?"category":"media"}?`,onConfirm:ee==="category"?Le:He,onCancel:()=>{w(!1),y.info("Delete action cancelled")}}),M&&e.jsx(te,{message:`Are you sure you want to ${M.type.replace("-"," ")}?`,onConfirm:()=>{M.type==="add-category"||M.type==="edit-category"?Ge():(M.type==="add-media"||M.type==="edit-media")&&Oe()},onCancel:()=>D(null)})]})})};export{La as default};
