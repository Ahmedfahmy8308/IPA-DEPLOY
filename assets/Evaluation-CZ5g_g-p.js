import{c as ee,r,a as z,j as e,ae as F}from"./index-BFIRCOFm.js";import{I as G}from"./input-C8a62OMq.js";import{B as N}from"./button-C7fbYyUg.js";import{D as se,a as te,b as re,c as ne,d as ie}from"./dialog-ngHf6tSK.js";import{d as v}from"./dayjs.min-DXzorgZG.js";import{B as T}from"./book-BGuU8E9L.js";import{U}from"./user-gTeU-oJe.js";import{C as ae}from"./calendar-CFygCBbd.js";import{C as M}from"./circle-check-big-Du36Hbe-.js";import{F as le}from"./Table-DEG_g8U6.js";import{L as H}from"./link-CZYwcepb.js";import{C as oe}from"./clock-DNZVvydn.js";import{L as de}from"./lock-DhT6ed89.js";import"./Combination-Cr6E-lIU.js";import"./tslib.es6-BUas5LQb.js";import"./index-CpFwwJTZ.js";import"./index-DcAOwtUU.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R=ee("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]),Ce=()=>{var A,P;const[B]=r.useState(!0),[y,_]=r.useState(""),[x,q]=r.useState(""),[n,w]=r.useState([]),[V,g]=r.useState(!1),[k,S]=r.useState(null),[$,p]=r.useState(!1),[o,L]=r.useState(""),[D,C]=r.useState(!1),[E,b]=r.useState(""),[f,X]=r.useState(null),[m,J]=r.useState(null),[d,l]=r.useState("github"),[u,i]=r.useState("");r.useEffect(()=>{g(!0),fetch(z+"GroupAssignments/student/submissions",{method:"GET",credentials:"include"}).then(s=>s.json()).then(s=>{s.success?w(s.data):S("Failed to fetch submissions"),g(!1)}).catch(()=>{S("Failed to fetch submissions"),g(!1)})},[]);const K=n.map(s=>({id:s.id,date:s.submissionDate?new Date(s.submissionDate).toLocaleDateString():"",attendance:s.wasPresent?"Present":"Absent",assignmentDelivery:s.submissionLink?"On time":"Not submitted",assignmentEvaluation:s.evaluationScore||"",bonus:s.bonusPoints,feedback:s.comments,course:s.courseName,instructor:s.instructorName,startDate:s.startDate?new Date(s.startDate).toLocaleDateString():""})),Q=Array.from(new Set(n.map(s=>s.courseName))),h=x||"All Courses",I={instructor:((A=n.find(s=>s.courseName===h))==null?void 0:A.instructorName)||"Multiple Instructors",startDate:((P=n.find(s=>s.courseName===h))==null?void 0:P.startDate)||"-"};[...K.filter(s=>s.date.includes(y)).filter(s=>!x||s.course===x)];const W=s=>{var t,a,c,O,Y;X(s.id),L(s.submissionLink||""),p(!0),b(""),i(""),J(s),(t=s.submissionLink)!=null&&t.includes("github.com")?l("github"):(a=s.submissionLink)!=null&&a.includes("drive.google.com")?l("googledrive"):(c=s.submissionLink)!=null&&c.includes("onedrive")?l("onedrive"):(O=s.submissionLink)!=null&&O.includes("dropbox.com")?l("dropbox"):(Y=s.submissionLink)!=null&&Y.includes("notion")?l("notion"):l("other")},Z=async()=>{if(f&&j(o)){C(!0),b("");try{const t=await(await fetch(`${z}GroupAssignments/sessions/submissions/${f}`,{method:"PUT",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({SubmissionLink:o})})).json();if(!t.success)throw new Error(t.message||"Failed to update link");w(a=>a.map(c=>c.id===f?{...c,submissionLink:o,updatedAt:new Date().toISOString()}:c)),p(!1),F({description:"Submission link updated successfully."})}catch(s){b(s instanceof Error?s.message:"Failed to update link"),F({title:"Error",description:s instanceof Error?s.message:"Failed to update link",variant:"destructive"})}finally{C(!1)}}},j=s=>{if(!s.trim())return i("Link is required. Please enter a valid URL."),!1;try{return new URL(s),d==="github"&&!s.includes("github.com")?(i("Link must be from GitHub"),!1):d==="googledrive"&&!s.includes("drive.google.com")?(i("Link must be from Google Drive"),!1):d==="onedrive"&&!s.includes("onedrive")?(i("Link must be from OneDrive"),!1):d==="dropbox"&&!s.includes("dropbox.com")?(i("Link must be from Dropbox"),!1):d==="notion"&&!s.includes("notion")?(i("Link must be from Notion"),!1):(i(""),!0)}catch{return i("Please enter a valid URL"),!1}};return e.jsxs("div",{className:"space-y-6 p-4 bg-gray-50 min-h-screen",children:[V&&e.jsx("div",{className:"text-center py-4",children:e.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-4 border-solid border-primary border-r-transparent"})}),k&&e.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-md",children:k}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-800",children:h}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"flex items-center space-x-4 p-4 rounded-lg border bg-white shadow-sm hover:shadow-md transition-shadow",children:[e.jsx("div",{className:"rounded-full bg-blue-100 p-3",children:e.jsx(T,{size:24,className:"text-blue-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Course"}),e.jsx("p",{className:"font-medium",children:h})]})]}),e.jsxs("div",{className:"flex items-center space-x-4 p-4 rounded-lg border bg-white shadow-sm hover:shadow-md transition-shadow",children:[e.jsx("div",{className:"rounded-full bg-green-100 p-3",children:e.jsx(U,{size:24,className:"text-green-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Instructor"}),e.jsx("p",{className:"font-medium",children:I.instructor})]})]}),e.jsxs("div",{className:"flex items-center space-x-4 p-4 rounded-lg border bg-white shadow-sm hover:shadow-md transition-shadow",children:[e.jsx("div",{className:"rounded-full bg-purple-100 p-3",children:e.jsx(ae,{size:24,className:"text-purple-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Start Date"}),e.jsx("p",{className:"font-medium",children:I.startDate})]})]})]})]}),B?e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center mb-4 gap-3",children:e.jsxs("div",{className:"flex items-center space-x-2 flex-wrap gap-2",children:[e.jsx(G,{placeholder:"Search by student or course...",value:y,onChange:s=>_(s.target.value),className:"max-w-xs"}),e.jsxs("select",{className:"px-3 py-2 border rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-primary",value:x,onChange:s=>q(s.target.value),children:[e.jsx("option",{value:"",children:"All Courses"}),Q.map(s=>e.jsx("option",{value:s,children:s},s))]})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[e.jsxs("div",{className:"bg-white p-4 rounded-lg shadow-sm border flex items-center",children:[e.jsx("div",{className:"rounded-full bg-blue-100 p-3 mr-4",children:e.jsx(U,{className:"h-6 w-6 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Total Submissions"}),e.jsx("p",{className:"text-xl font-bold",children:n.length})]})]}),e.jsxs("div",{className:"bg-white p-4 rounded-lg shadow-sm border flex items-center",children:[e.jsx("div",{className:"rounded-full bg-green-100 p-3 mr-4",children:e.jsx(M,{className:"h-6 w-6 text-green-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Present"}),e.jsx("p",{className:"text-xl font-bold",children:n.filter(s=>s.wasPresent===!0).length})]})]}),e.jsxs("div",{className:"bg-white p-4 rounded-lg shadow-sm border flex items-center",children:[e.jsx("div",{className:"rounded-full bg-red-100 p-3 mr-4",children:e.jsx(R,{className:"h-6 w-6 text-red-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Absent"}),e.jsx("p",{className:"text-xl font-bold",children:n.filter(s=>s.wasPresent===!1).length})]})]}),e.jsxs("div",{className:"bg-white p-4 rounded-lg shadow-sm border flex items-center",children:[e.jsx("div",{className:"rounded-full bg-yellow-100 p-3 mr-4",children:e.jsx(T,{className:"h-6 w-6 text-yellow-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Avg Score"}),e.jsx("p",{className:"text-xl font-bold",children:(()=>{const s=n.map(t=>typeof t.evaluationScore=="number"?t.evaluationScore:t.evaluationScore==="excellent"?4:t.evaluationScore==="good"?3:t.evaluationScore==="average"?2:t.evaluationScore==="needs_improvement"?1:0).filter(t=>t>0);return s.length===0?"0":(s.reduce((t,a)=>t+a,0)/s.length).toFixed(1)})()})]})]})]}),e.jsx("div",{className:"max-w-full overflow-x-auto",children:e.jsx(le,{columns:[{title:"ID",dataIndex:"id",width:80,sorter:(s,t)=>s.id-t.id},{title:"Submission Link",dataIndex:"submissionLink",render:s=>s?e.jsxs("a",{href:s,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-800 inline-flex items-center gap-1",children:[e.jsx(H,{className:"h-4 w-4"}),e.jsx("span",{className:"underline",children:"View Submission"})]}):e.jsx("span",{className:"text-gray-400 italic",children:"Not submitted"})},{title:"Attendance",dataIndex:"wasPresent",render:s=>s===!0?e.jsxs("span",{className:"inline-flex items-center gap-1 px-2.5 py-0.5 rounded-full text-sm font-medium bg-green-100 text-green-800",children:[e.jsx(M,{size:16})," Present"]}):s===!1?e.jsxs("span",{className:"inline-flex items-center gap-1 px-2.5 py-0.5 rounded-full text-sm font-medium bg-red-100 text-red-800",children:[e.jsx(R,{size:16})," Absent"]}):e.jsxs("span",{className:"inline-flex items-center gap-1 px-2.5 py-0.5 rounded-full text-sm font-medium bg-yellow-100 text-yellow-800",children:[e.jsx(oe,{size:16})," Late"]})},{title:"Evaluation",dataIndex:"evaluationScore",render:s=>{let t="";typeof s=="number"?t={4:"Excellent",3:"Good",2:"Average",1:"Needs improvement"}[s]||String(s):t=s==="excellent"?"Excellent":s==="good"?"Good":s==="average"?"Average":s==="needs_improvement"?"Needs improvement":s||"-";const a=(()=>{switch(t){case"Excellent":return"bg-purple-100 text-purple-800";case"Good":return"bg-blue-100 text-blue-800";case"Average":return"bg-gray-100 text-gray-800";case"Needs improvement":return"bg-orange-100 text-orange-800";default:return""}})();return a?e.jsx("span",{className:`inline-flex px-2.5 py-0.5 rounded-full text-sm font-medium ${a}`,children:t}):e.jsx("span",{children:t})}},{title:"Bonus",dataIndex:"bonusPoints",render:s=>s>0?e.jsxs("span",{className:"font-medium text-green-600",children:["+",s]}):e.jsx("span",{children:s})},{title:"Date",dataIndex:"submissionDate",render:s=>s?v(s).format("YYYY-MM-DD HH:mm"):"-"},{title:"Comments",dataIndex:"comments",render:s=>s?e.jsx("div",{className:"max-w-xs truncate",title:s,children:s}):e.jsx("span",{className:"text-gray-400 italic",children:"No comments"})},{title:"Course",dataIndex:"courseName"},{title:"Instructor",dataIndex:"instructorName"},{title:"Start Date",dataIndex:"startDate",render:s=>s?v(s).format("YYYY-MM-DD"):"-"},{title:"Lesson Name",dataIndex:"lessonName"},{title:"Lesson Order",dataIndex:"lessonOrder"},{title:"Updated At",dataIndex:"updatedAt",render:s=>s?v(s).format("YYYY-MM-DD HH:mm"):"-"},{title:"Actions",key:"actions",render:(s,t)=>e.jsxs(N,{variant:"outline",size:"sm",className:"text-blue-600 border-blue-300 hover:bg-blue-50 hover:text-blue-700 w-full",onClick:()=>W(t),children:[e.jsx(H,{className:"h-4 w-4 mr-1"}),"Edit"]})}],dataSource:n,rowKey:"id",pagination:{pageSize:10},scroll:{x:"max-content"}})}),e.jsx(se,{open:$,onOpenChange:p,children:e.jsxs(te,{className:"sm:max-w-md",children:[e.jsx(re,{children:e.jsx(ne,{children:"Edit Submission Link"})}),e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{htmlFor:"link-type",className:"block text-sm font-medium",children:"Select Platform"}),e.jsxs("select",{id:"link-type",className:"block w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",value:d,onChange:s=>{l(s.target.value),o&&j(o)},children:[e.jsx("option",{value:"github",children:"GitHub"}),e.jsx("option",{value:"googledrive",children:"Google Drive"}),e.jsx("option",{value:"onedrive",children:"OneDrive"}),e.jsx("option",{value:"dropbox",children:"Dropbox"}),e.jsx("option",{value:"notion",children:"Notion"}),e.jsx("option",{value:"other",children:"Other"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{htmlFor:"edit-assignment-link",className:"block text-sm font-medium",children:"Submission Link"}),e.jsx(G,{id:"edit-assignment-link",type:"url",placeholder:"Paste the submission link here",value:o,onChange:s=>{L(s.target.value),u&&j(s.target.value)},className:u?"border-red-500 focus:ring-red-500":""}),u?e.jsx("p",{className:"text-xs text-red-600 font-medium",children:u}):e.jsx("p",{className:"text-xs text-muted-foreground",children:"Ensure the link is accessible by the instructor"})]}),m&&e.jsxs("div",{className:"rounded-md bg-blue-50 p-3 text-sm",children:[e.jsx("p",{className:"font-medium text-blue-800",children:"Assignment Details"}),e.jsxs("p",{className:"text-blue-700 mt-1",children:["Course: ",m.courseName]}),e.jsxs("p",{className:"text-blue-700",children:["Lesson: ",m.lessonName," (#",m.lessonOrder,")"]}),e.jsxs("p",{className:"text-blue-700",children:["Instructor: ",m.instructorName]})]})]}),E&&e.jsx("div",{className:"text-red-500 mt-2 text-sm bg-red-50 p-2 rounded",children:E})]}),e.jsxs(ie,{children:[e.jsx(N,{type:"button",variant:"secondary",onClick:()=>p(!1),children:"Cancel"}),e.jsx(N,{type:"button",onClick:Z,disabled:D||!!u,className:"bg-primary hover:bg-primary/90",children:D?"Sending...":"Submit Link"})]})]})})]}):e.jsxs("div",{className:"flex flex-col items-center justify-center p-12 border rounded-md bg-gray-50",children:[e.jsx(de,{size:48,className:"text-gray-400 mb-4"}),e.jsx("h2",{className:"text-xl font-semibold mb-2",children:"Admin Access Required"}),e.jsx("p",{className:"text-muted-foreground text-center max-w-md",children:"You need administrator privileges to access the evaluation records. Please contact your instructor or system administrator for assistance."})]})]})};export{Ce as default};
